## ORM, JPA, Hibernate
**Object-to-Relational Mapping (ORM)** means the Mapping between Java class and database table.

**Jakarta Pesistence API (JPA)** is a Standard API for Object-to-Relational Mapping. It is only a specification
- defines a set of interface
- requires an inplementation to be useable.

**Hibernate** is a framework for persisting / saving Java objects in a database. Hibernate provides the Object-to-Relational Mapping (ORM). It is an implementation of JPA.

**Java DataBase Connectivity (JDBC)** is an API for conncecting and executing queries on a database for Java. JDBC can work with any database as long as proper drivers are provided. 

**Relationship between Hibernate/JPA and JDBC** <br>
Hibernate/JPA uses JDBC for all database communications. Hibernate/JPA <=> JDBC <=> Datebase. <br>
Add JDBC connection info in the application.properties
```
// Spring use JDBC for mySQL database communication
spring.datasource.url=jdbc:mysql://localhost:3306/student_tracker
spring.datasource.username=springstudent
spring.datasource.password=springstudent
```



### CRUD (= Create, Read, Update, Delete )

#### Entity class
Java class that is mapped to a database table.
- Must be annotated with @Entity
- Must have a public or protected no-argument constructor

### Data Access Object (DAO)
DAO is a common design pattern. DAO is responsible for interfacing with the database. (like a helper for communicating with the database) DAO needs a JPA Entity Manager.<br>

### JPA Entity Manager
JPA Entity Manager is the main component for saving and retrieving entities. JPA Entity Manager is automatically created by Spring Boot. JPA Entity Manager needs a Data Source.<br>
- entityManager.persist(obj): create obj
- entityManager.find(obj): read obj
- entityManager.merge(obj): update obj
- entityManager.remove(obj): delete obj

### Data Source
Data source defines database connection info. Data Source is automatically created by Spring Boot based on the file application properties (JDBC URL, user id, password, etc...)

### Java Persistence Query Language (JPQL) 
JPQL is based on **entity name** and **entity fields** in the **java class**. <br>
Statement: FROM, WHERE, =, OR, LIKE, order by, asc(ascending), desc(descending), UPDATE, SET, DELETE<br>
JPQL Named Parameters are prefixed with a colon ':'. JPQL Named Parameters is as a placeholder.<br>

### Create database tables from Java Code
```
spring.jpa.hibernate.ddl-auto=create
```
- none: No action will be performed
- create-only: Database tables are only created
- drop: Database tables are dropped
- create: Database tables are dropped followed by database tables creation
- create-drop: Database tables are dropped followed by database tables creation. On application shutdown, drop the database tables. For unit testing
- validate: Validate the database tables schema
- update: Update the database tables schema

### Spring Data JPA
Spring Data JPA create a DAO and just plug in your entity type and primary key. Spring will give a CRUD implementation. Spring Data JPA provides the interface JpaRepository.<br>

### Spring Data REST
- Spring Data REST will scan your project for JpaRepository
- Expose REST APIs for each entity type for your JpaRepository
- Spring Data REST will create endpoints based on entity type. 
- Spring Data REST endpoints are HATEOAS compliant. (HATEOAS: Hypermedia as the Engine of Application State, think of it as meta-data for REST data)
- Set base path in the application.properties
```
spring.data.rest.base-path=/magic-api
```
- Specify plural name/ path with an annotation: @RepositoryRestResource(path="members")
- Pagination: default page size is 20. 
```
spring.data.rest.default-page-size=50
```
- Sort: default is ascending
````
http://localhost:8080/employees?sort=lastName,desc
```


#### Annotations
- @Entity
- @Table(name="tablename"): If not specified, table name is the same name as class name.
- @Column(name="columnname"): @Column is optional. If not specified, column name is the same name as java field.
- @Id: marks the field as the primary key. Java primitive and primitive wrapper types, String, Date, BigDecimal and BigInteger
- @GeneratedValue: Automatically generate the primary key value. The id value will be generated by the database and managed by the database.
  - GenerationType.AUTO:
  - GenerationType.IDENTITY:
  - GenerationType.SEQUENCE:
  - GenerationType.TABLE:
- @Transactional: begin and end a transaction for the JPA code
- @Repository:

